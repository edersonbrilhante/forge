{
    "title": "Trust Relationship",
    "description": "",
    "inputs": {
        "input_global_trp": {
            "options": {
                "defaultValue": "-7d@h,now",
                "token": "global_time"
            },
            "title": "Global Time Range",
            "type": "input.timerange"
        },
        "input_uFiEIG6X": {
            "context": {},
            "dataSources": {},
            "options": {
                "items": ${jsonencode(
                    concat(
                        [{ label = "Select Tenant", value = "-" }],
                        [for tenant in tenants : { label = tenant, value = tenant }]
                    )
                )},
                "selectFirstSearchResult": true,
                "token": "dd_8enHUmpH"
            },
            "title": "Forge Tenant",
            "type": "input.dropdown"
        }
    },
    "defaults": {
        "dataSources": {
            "ds.o11y": {
                "options": {
                    "queryParameters": {
                        "earliest": "$global_time.earliest$",
                        "latest": "$global_time.latest$"
                    }
                }
            },
            "ds.search": {
                "options": {
                    "queryParameters": {
                        "earliest": "$global_time.earliest$",
                        "latest": "$global_time.latest$"
                    }
                }
            }
        }
    },
    "visualizations": {
        "viz_YqZBTBIB": {
            "containerOptions": {},
            "dataSources": {
                "primary": "ds_yDvZOb30"
            },
            "eventHandlers": [],
            "options": {
                "count": 20
            },
            "showLastUpdated": false,
            "showProgressBar": false,
            "title": "",
            "type": "splunk.table"
        }
    },
    "dataSources": {
        "ds_yDvZOb30": {
            "name": "Trust relationship validation",
            "options": {
                "enableSmartSources": true,
                "query": "index=\"${splunk_index}\" forgecicd_tenant=\"$dd_8enHUmpH$\" forgecicd_log_type=\"forge-trust-validator\" \"Validation complete\"\n| eventstats max(_time) as tenant_last_seen by forgecicd_tenant\n| where _time=tenant_last_seen\n\n| mvexpand forgecicd_trust_validation\n| eval trust_json=tostring(forgecicd_trust_validation)\n| spath input=trust_json path={} output=item\n| mvexpand item\n| spath input=item path=forge_role_arn output=forge_role\n| spath input=item path=tenant_results{} output=tenant_results\n| mvexpand tenant_results\n| spath input=tenant_results\n\n| eval assume_status=if(tostring(assume_role_success)==\"true\",\"assumed\",\"not assumed\")\n| eval tag_status=if(tostring(tag_session_success)==\"true\",\"session tagged\",\"session not tagged\")\n\n| table forgecicd_tenant forge_role tenant_role_arn assume_status assume_role_error tag_status tag_session_error\n| sort forge_role tenant_role_arn",
                "queryParameters": {
                    "earliest": "$global_time.earliest$",
                    "latest": "$global_time.latest$"
                }
            },
            "type": "ds.search"
        }
    },
    "layout": {
        "globalInputs": [
            "input_global_trp",
            "input_uFiEIG6X"
        ],
        "layoutDefinitions": {
            "layout_6CHuojec": {
                "options": {
                    "gutterSize": 9
                },
                "structure": [
                    {
                        "item": "viz_YqZBTBIB",
                        "position": {
                            "h": 974,
                            "w": 1200,
                            "x": 0,
                            "y": 0
                        },
                        "type": "block"
                    }
                ],
                "type": "grid"
            }
        },
        "options": {},
        "tabs": {
            "items": [
                {
                    "label": "Trust Relationship Validation",
                    "layoutId": "layout_6CHuojec"
                }
            ]
        }
    },
    "applicationProperties": {
        "collapseNavigation": true,
        "hideEdit": false,
        "hideExport": false,
        "hideOpenInSearch": false
    }
}
